"""
存放项目中用到的所有 LangChain 提示模板。
将提示与业务逻辑分离，便于管理和复用。
"""
from langchain_core.prompts import PromptTemplate

# 1. 规划阶段的提示模板
PLANNER_PROMPT = PromptTemplate.from_template(
    """
### 指令 ###
你是一位富有经验的写作规划专家。请根据用户的写作需求，以清晰、结构化的方式生成一份详细的写作计划。
{writing_style_instruction}

### 用户需求 ###
{user_prompt}

### 输出格式 ###
请严格按照以下Markdown格式输出，不要有任何多余的解释：

**1. 核心主题 (Core Theme):**
一句话概括文章最核心的思想。

**2. 目标读者 (Target Audience):**
描述这篇文章是写给谁看的，他们的背景和已有知识水平是怎样的。

**3. 叙事风格/语调 (Style/Tone):**
描述文章的整体感觉，例如：专业、严肃、风趣、通俗易懂、暗黑、悬疑等。

**4. 核心要点 (Key Points):**
- 要点一：文章需要阐述的第一个主要观点。
- 要点二：文章需要阐述的第二个主要观点。
- 要点三：文章需要阐述的第三个主要观点。

**5. 预估篇幅 (Estimated Length):**
根据用户需求，预估一个大致的篇幅（如：短篇博客约800-1200字，深度报告约3000-5000字等）。
"""
)


# 后续可以继续添加其他步骤的提示模板
# e.g., OUTLINER_PROMPT, DRAFTER_PROMPT, etc.

# 2. 研究阶段的提示模板
RESEARCH_QUERY_PROMPT = PromptTemplate.from_template(
    """
### 指令 ###
你是一位高效的信息检索专家。请根据以下“写作计划”和“用户原始需求”，生成3-5个最相关、最有效的Web搜索查询词。
{writing_style_instruction}

### 用户原始需求 ###
{user_prompt}

### 写作计划 ###
{plan}

### 输出格式 ###
请严格按照以下格式输出，每个查询词占一行，不要有任何编号或多余的字符：
查询词1
查询词2
查询词3
...
"""
)

SUMMARIZER_PROMPT = PromptTemplate.from_template(
    """
### 指令 ###
你是一位资深的行业分析师。请整合、提炼以下“网络搜索结果”，并根据“用户原始需求”，生成一份简明扼要、重点突出的研究摘要。摘要应包含关键事实、数据和不同角度的观点。
{writing_style_instruction}

### 用户原始需求 ###
{user_prompt}

### 网络搜索结果 ###
{search_results}

### 输出格式 ###


"""
)
# 3. 大纲阶段的提示模板
OUTLINER_PROMPT = PromptTemplate.from_template(
    """
### 指令 ###
你是一位顶级的结构设计师和内容策划师。你的任务是结合“写作计划”、“研究摘要”和“用户原始需求”，为即将创作的文章设计一个详尽、富有逻辑层次的写作大纲。

{writing_style_instruction}

### 上一个版本的大纲 (如果存在) ###
{outline}

### 用户优化指令 (可选) ###
{refinement_instruction}

### 用户原始需求 ###
{user_prompt}

### 写作计划 ###
{plan}

### 研究摘要 ###
{research_results}

### 输出格式 ###
请使用Markdown的嵌套项目符号格式输出一个**完整**的新大纲。
- 如果“上一个版本的大纲”和“用户优化指令”都提供了，请将优化指令作为最高优先级，对上一个版本的大纲进行修改和完善，然后输出**完整的新版大纲**。
- 如果只有“上一个版本的大纲”，请忽略它并根据其他信息生成一个全新的大纲。
- 如果指令为空，则正常生成大纲。

**示例输出格式:**
- **引言**
    - a. 引入主题：用一个引人入胜的故事或数据开头。
    - b. 提出核心问题/论点：明确本文要解决什么问题或阐述什么观点。
    - c. 概述文章结构：简要介绍接下来将要讨论的几个部分。
- **第一部分：[章节标题]**
    - a. [小节标题]
        - i. 论点1的支撑细节
        - ii. 引用研究摘要中的数据/案例
    - b. [小节标题]
- **第二部分：[章节标题]**
    - a. ...
- **结论**
    - a. 总结核心论点。
    - b. 提出未来展望或行动号召。
"""
)

# 4. 撰写阶段的提示模板
DRAFTER_PROMPT = PromptTemplate.from_template(
    """
### 指令 ###
你是一位专业的作家。你的任务是根据“整体写作大纲”和“研究摘要”，专注于撰写并扩充“当前需要撰写的章节”。请确保你的写作风格、语调与用户的原始需求保持一致，并自然地融入研究摘要中的相关信息。
{writing_style_instruction}

### 用户原始需求 ###
{user_prompt}

### 整体写作大纲 ###
{outline}

### 研究摘要 ###
{research_results}

### 相关记忆上下文 (由RAG系统提供) ###
{retrieved_context}

### 当前需要撰写的章节 ###
{section_to_write}

### 输出要求 ###
- **只输出**“当前需要撰写的章节”的正文内容。
- **不要**包含章节标题。
- **不要**重复指令或对自己进行评论。
- 你的输出将直接作为文章的一部分，所以请直接开始写作。
"""
)

# 5. 修订阶段的提示模板
REVISER_PROMPT = PromptTemplate.from_template(
    """
### 指令 ###
你是一位追求卓越的资深总编辑。你的任务是审查、修订和润色下面的“文章初稿”，使其达到可出版的质量标准。你需要严格对照“写作计划”和“整体大纲”，从全局视角进行优化。
{writing_style_instruction}

### 写作计划 ###
{plan}

### 整体大纲 ###
{outline}

### 相关记忆上下文 (由RAG系统提供) ###
{retrieved_context}

### 文章初稿 ###
{full_draft}

### 修订要求 ###
请根据以下清单进行全面修订：
1.  **逻辑与流畅性:** 检查段落之间、章节之间的过渡是否自然、流畅？论证逻辑是否严密，无明显漏洞？
2.  **一致性:** 文章的语调、风格是否从头到尾保持一致？所有内容是否都严格遵循了最初的“写作计划”和“大纲”？
3.  **语言润色:** 修正所有语法、拼写和标点错误。将拗口、复杂或表达不清的句子改写得更清晰、更优雅。
4.  **简洁性:** 删除所有不必要的重复、冗余的词语或句子，确保每一个字都有其价值。
5.  **增强可读性:** 在适当的地方，可以考虑调整句子结构，增加一些比喻或实例，使文章更具吸引力。

### 输出格式 ###
请直接输出经过你精心修订后的**完整最终稿件**。不要发表任何评论或解释。
"""
)


